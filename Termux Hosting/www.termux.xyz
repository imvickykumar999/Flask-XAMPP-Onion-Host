import hashlib
import base64
import sys
from cryptography.hazmat.primitives.asymmetric import rsa
from cryptography.hazmat.backends import default_backend
from cryptography.hazmat.primitives import serialization

def get_rsa_key():
    return rsa.generate_private_key(public_exponent = 0x10001, key_size = 0x400, backend = default_backend())

def find_onion(public_bytes):
    public_key_bytes = bytearray(base64.b64decode(public_bytes))
    sha_1 = hashlib.sha1()
    sha_1.update(public_key_bytes)
    digest = sha_1.digest()
    b32 = base64.b32encode(digest).decode('utf-8')
    return str(b32[:16].lower()) + '.onion'

def get_public_part(private_key):
    public_key = private_key.public_key()
    public_bytes = public_key.public_bytes(encoding = serialization.Encoding.PEM, format = serialization.PublicFormat.PKCS1).decode('utf-8')
    return ''.join(public_bytes.splitlines()[1:-1])

def match(desired, onion):
    return onion.startswith(desired)

def get_private_key_str(private_key):
    pem = private_key.private_bytes(encoding = serialization.Encoding.PEM, format = serialization.PrivateFormat.TraditionalOpenSSL, encryption_algorithm=serialization.NoEncryption())
    return pem.decode('utf-8')

def print_info(*argv):
    for a in argv:
        print(a)

def write_text_to_file(path, text):
    with open(path, 'w+') as text_file:
        text_file.write(text)

def run(desired):
    while True:
        private_key = get_rsa_key()
        public_part = get_public_part(private_key)
        onion = find_onion(public_part)
        if match(desired, onion):
            key_str = get_private_key_str(private_key)
            write_text_to_file('hidden_service/private_key', key_str)
            print_info(onion)
            break

if __name__ == '__main__':
    desired = sys.argv[1]
    run(desired)















<script type = 'text/javascript' >
    //<![CDATA[
    var head = document.head || document.getElementsByTagName("head")[0],
        style = document.createElement("style");
style.type = "text/css";
var css = "#block_abdoutech{text-align:center;background:rgba(0,0,0,.85)!important;position:fixed;top:0;left:0;display:table;width:100%;height:100%;z-index:999999}.ndcyidc{vertical-align:middle;display:table-cell!important;text-align:center;visibility:visible!important;color:#fff!important}.smmpog{display:block!important;box-sizing:border-box!important;background-image:url(data:image/svg+xml;base64,PHN2ZyBpZD0iXzEiIGRhdGEtbmFtZT0iMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTg2IiBoZWlnaHQ9IjE4NiIgdmlld0JveD0iMCAwIDkzIDkzIj48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2Y3ZjdmN30uY2xzLTJ7ZmlsbDojZTcxZDM2O2ZpbGwtcnVsZTpldmVub2RkfTwvc3R5bGU+PC9kZWZzPjxjaXJjbGUgY2xhc3M9ImNscy0xIiBjeD0iNDkiIGN5PSI0OSIgcj0iMzQiLz48cGF0aCBjbGFzcz0iY2xzLTIiIGQ9Ik03MzAuODUgMjg0LjY0NWEyLjYzOCAyLjYzOC4wIDAgMC0uNzQ4LTEuODY5QTIuNTYgMi41Ni4wIDAgMCA3MjguMjcgMjgyYTIuNjI0IDIuNjI0LjAgMCAwLTIuNjE3IDIuNjE2VjMwMy45bDUuMi4wMTZWMjg0LjY0NXptNy4wNzYgMjAuMjM4YzAtNi4yLS4wMDktMTIuMzM5LS4wMDktMTIuNDQ1YTIuNTUgMi41NS4wIDAgMC0yLjUxLTIuNjQzIDIuNjM3IDIuNjM3LjAgMCAwLTIuNjQyIDIuNjE3djExLjUxaC45NjFhLjk1OC45NTguMCAwIDEtLjAwNiAxLjkxNWgtMS44MDljLS4wMzQuMC0uMDY5LjAtLjEuMGEuOTUxLjk1MS4wIDAgMS0uMTA4LS4wMDZsLTE2LjEzLS4wNTFhLjk1Ny45NTcuMCAwIDEtLjk1MS0uOS42MDguNjA4LjAgMCAxIDAtLjA2MS45NTcuOTU3LjAgMCAxIC45Ni0uOTU0aC45NTVWMzAxYS45NTguOTU4LjAgMCAxIDEuOTE1LjB2Mi44ODJsNS4yOTIuMDE2VjI3OS41NTZhMi42MjcgMi42MjcuMCAwIDAtMi42MTctMi42NDEgMi42NTIgMi42NTIuMCAwIDAtMi42NzUgMi42MTZ2MTcuNjM0YS45NTguOTU4LjAgMSAxLTEuOTE1LjBWMjg0LjU1OGEyLjYyNSAyLjYyNS4wIDAgMC0yLjYtMi42MTIgMi43IDIuNy4wIDAgMC0yLjcgMi42MTd2MjcuNjEzYTExLjY3MSAxMS42NzEuMCAwIDEgNy40MTEgMy40ODYgMTEuOSAxMS45LjAgMCAxIDMuNCA4LjQzMy45NTguOTU4LjAgMCAxLTEuOTE1LS4wMDhBMTAgMTAgMCAwIDAgNzE3LjI3NSAzMTdhOS43OTQgOS43OTQuMCAwIDAtNy4wMDYtMi45NTIuOTU3Ljk1Ny4wIDAgMS0uOTUzLS45NTdWMjk4LjNhMi42MjggMi42MjguMCAwIDAtNS4yNTYuMGMwIC4xMTkuMDIxIDEyLjMuMCAxNy42OTVhLjgyOC44MjguMCAwIDEgLjAxMi4xNSAxNi45MzQgMTYuOTM0LjAgMCAwIDMzLjg2Ni4yODMgMSAxIDAgMCAxLS4wMjEtLjJDNzM3LjkyNiAzMTMuOTg4IDczNy45MjggMzA5LjQyMSA3MzcuOTI2IDMwNC44ODN6bTI3LjE3LTIxLjU0OEw3NDEuNjY1IDI1OS45YTYuNDU4IDYuNDU4LjAgMCAwLTQuNi0xLjlINzAzLjkzMmE2LjQ1OCA2LjQ1OC4wIDAgMC00LjYgMS45bC01LjcxNCA1LjcxNGgwTDY3NS45IDI4My4zMzVhNi40NjQgNi40NjQuMCAwIDAtMS45IDQuNnYzMy4xMzZhNi40NTkgNi40NTkuMCAwIDAgMS45IDQuNkw2OTkuMzM1IDM0OS4xYTYuNDU4IDYuNDU4LjAgMCAwIDQuNiAxLjloMzMuMTM2YTYuNDU4IDYuNDU4LjAgMCAwIDQuNi0xLjlsNS43MTQtNS43MTRoMEw3NjUuMSAzMjUuNjY1YTYuNDYyIDYuNDYyLjAgMCAwIDEuOS00LjZWMjg3LjkzMkE2LjQ2MSA2LjQ2MS4wIDAgMCA3NjUuMSAyODMuMzM1em0tMzAuNzIxIDQ2LjE4NkExOC42NTggMTguNjU4LjAgMCAxIDcyMS4wODggMzM1YTE4LjkxMyAxOC45MTMuMCAwIDEtMTguOTMtMTguNjk0LjkyNy45MjcuMCAwIDEtLjAxMy0uMTU4Yy4wMjEtNS4zMDUuMC0xNy43MTguMC0xNy44NDNhNC41NTEgNC41NTEuMCAwIDEgNC41NDEtNC41MjloLjAxOWE0LjUxIDQuNTEuMCAwIDEgMi42MS44NDN2LTEwLjA2YTQuNTg1IDQuNTg1LjAgMCAxIDQuNjA3LTQuNTI4aC4wMThhNC40ODQgNC40ODQuMCAwIDEgMi41OTEuODM3di0xLjM0MWE0LjU3IDQuNTcuMCAwIDEgNC41OC00LjUyN2guMDE4YTQuNTQzIDQuNTQzLjAgMCAxIDQuNTI0IDQuNTZ2MS4zNjNhNC40NzggNC40NzguMCAwIDEgMi42MDYtLjgzNGguMDE5YTQuNDU4IDQuNDU4LjAgMCAxIDMuMTkyIDEuMzQ4IDQuNTM2IDQuNTM2LjAgMCAxIDEuMjk1IDMuMjEydjQuMDczYTQuNTI3IDQuNTI3LjAgMCAxIDIuNjMxLS44NDJoLjAxOWE0LjQ0MyA0LjQ0My4wIDAgMSA0LjQxNyA0LjU2MWMwIC4xNzcuMDIxIDE4LjAzMS4wIDIzLjU5MmEuOS45LjAgMCAxIC4wMjIuMkExOC42NTQgMTguNjU0LjAgMCAxIDczNC4zNzUgMzI5LjUyMXoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC02NzQgLTI1OCkiLz48L3N2Zz4=);width:93px!important;height:93px!important;background-size:93px 93px!important;margin:auto!important;background-repeat:no-repeat!important;background-position:center!important}.tegri{margin:.67em!important;font-size:26px!important;font-weight:700!important;display:block!important;box-sizing:border-box!important;margin-top:50px!important;letter-spacing:0!important}.uogtc{font-size: 18px;margin:1em!important;display:block!important;box-sizing:border-box!important;line-height:1.65!important;margin-bottom:50px!important}.vxyvvs{margin:0 15px 0 0!important;display:inline-block!important;background:0 0!important;border:1px solid rgba(256,256,256,.4)!important;border-radius:3px!important;color:#fff!important;text-transform:uppercase!important;font-size:13px!important;font-weight:700!important;padding:10px 25px 10px 25px!important;outline:0!important;cursor:pointer!important;background-repeat:no-repeat!important;background-position:75px 11px!important;box-sizing:border-box!important;line-height:15px!important;background-color:#21d790!important;border-color:#21d790!important;white-space:nowrap!important;overflow:hidden!important;text-overflow:ellipsis!important;max-width:calc(100% - 50px)!important;}.xvwawzk{margin:0 15px 0 0!important;display:inline-block!important;background:0 0!important;border:1px solid rgba(256,256,256,.4)!important;border-radius:3px!important;color:#fff!important;text-transform:uppercase!important;font-size:13px!important;font-weight:700!important;padding:10px 45px 10px 25px!important;outline:0!important;cursor:pointer!important;background-repeat:no-repeat!important;background-position:130px 11px!important;box-sizing:border-box!important;line-height:15px!important;white-space:nowrap!important;overflow:hidden!important;text-overflow:ellipsis!important;max-width:calc(100% - 50px)!important;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMS4xNTYiIGhlaWdodD0iMTIuMDYzIiB2aWV3Qm94PSIwIDAgMTEuMTU2IDEyLjA2MyI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiNmZmY7ZmlsbC1ydWxlOmV2ZW5vZGR9PC9zdHlsZT48L2RlZnM+PHBhdGggaWQ9ImRpc2FibGUiIGNsYXNzPSJjbHMtMSIgZD0iTTc0My4yNzggNTcwLjE2NmE1LjQ2MSA1LjQ2MS4wIDAgMC0xLjY0NC0xLjk1OS45LjkuMCAwIDAtLjY4OS0uMTgxLjg2My44NjMuMCAwIDAtLjYwOS4zNjIuODg1Ljg4NS4wIDAgMC0uMTc4LjY4Ni45LjkuMCAwIDAgLjM1OS42MTMgMy43IDMuNy4wIDAgMSAxLjEgMS4zMTMgMy43IDMuNy4wIDAgMSAuMSAzLjA5NCAzLjY4MSAzLjY4MS4wIDAgMS0xLjk4MSAxLjk4IDMuNjc0IDMuNjc0LjAgMCAxLTIuODguMCAzLjY3NCAzLjY3NC4wIDAgMS0xLjk4LTEuOTggMy43IDMuNy4wIDAgMSAuMDk0LTMuMDk0IDMuNzExIDMuNzExLjAgMCAxIDEuMS0xLjMxMy45LjkuMCAwIDAgLjM1OS0uNjEzLjg4NS44ODUuMCAwIDAtLjE3OC0uNjg2Ljg1OS44NTkuMCAwIDAtLjYwNS0uMzYyLjkxNi45MTYuMCAwIDAtLjY5My4xODEgNS41NCA1LjU0LjAgMCAwLTEuNzg1IDYuNjA5IDUuNTEgNS41MS4wIDAgMCAyLjk2NyAyLjk2NyA1LjUwOSA1LjUwOS4wIDAgMCA0LjMyNC4wIDUuNTEgNS41MS4wIDAgMCAyLjk2Ny0yLjk2NyA1LjQyNSA1LjQyNS4wIDAgMCAuNDQzLTIuMTYyQTUuNDkxIDUuNDkxLjAgMCAwIDc0My4yNzggNTcwLjE2NnptLTQuMzM1LTMuNzM2YS45MjguOTI4LjAgMCAwLTEuNTgxLjY1M3Y0LjY0MmEuOTI5LjkyOS4wIDAgMCAxLjg1Ny4wdi00LjY0MkEuODkyLjg5Mi4wIDAgMCA3MzguOTQzIDU2Ni40M3oiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC03MzIuNzE5IC01NjYuMTU2KSIvPjwvc3ZnPg==)!important}#adsclose,#fanclose,#mgclose{font-size:27px;cursor:pointer;position:absolute;top:0;left:0;transition:all .2s;color:rgba(0,0,0,.3);display:flex}#adsclose:hover,#fanclose:hover,#mgclose:hover{color:#fff}";
style.appendChild(document.createTextNode(css)), head.appendChild(style), ! function() {
    function M() {
        var M = document.createElement("div");
        M.id = "lock_msg", M.innerHTML = "<span id='lock_abdoutech' style='display: table !important; visibility: visible !important;'> <div class='ndcyidc' style=' display: table-cell !important; visibility: visible !important; '> <div class='smmpog' style='visibility: visible !important;display: block !important;'></div> <h1 class='tegri' style=' display: block !important; visibility: visible !important; '></h1> <p class='uogtc' style=' display: block !important; visibility: visible !important; '></p> <a role='button' href='https://termux.xyz/' class='kghqeps vxyvvs' style='visibility: visible !important;display: inline-block !important;'>Refresh the Page</a> </div></span></div>", document.body.append(M), document.body.style.overflow = "hidden"
    }
    var t = document.createElement("script");
    t.type = "text/javascript", t.async = !0, t.src = "https://pagead2.googlesyndication.com/pagead/managed/js/adsense/m202109080101/show_impl_fy2019.js", t.onerror = function() {
        M(), window.adblock = !0
    };
    var i = document.getElementsByTagName("script")[0];
    i.parentNode.insetBefore(t, i)
}();
//]]>
</script>
